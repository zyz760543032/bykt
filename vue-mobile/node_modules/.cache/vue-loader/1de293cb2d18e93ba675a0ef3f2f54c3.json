{"remainingRequest":"D:\\vscode\\ggkt\\vue-mobile\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\vscode\\ggkt\\vue-mobile\\src\\views\\play.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\vscode\\ggkt\\vue-mobile\\src\\views\\play.vue","mtime":1651821295395},{"path":"D:\\vscode\\ggkt\\vue-mobile\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\vscode\\ggkt\\vue-mobile\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"D:\\vscode\\ggkt\\vue-mobile\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\vscode\\ggkt\\vue-mobile\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBjb3Vyc2VBcGkgZnJvbSAnQC9hcGkvY291cnNlJwppbXBvcnQgdm9kQXBpIGZyb20gJ0AvYXBpL3ZvZCcKLy8gaW1wb3J0IHZpZGVvVmlzaXRvckFwaSBmcm9tICdAL2FwaS92aWRlb1Zpc2l0b3InCmV4cG9ydCBkZWZhdWx0IHsKICAgIGRhdGEoKSB7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgbG9hZGluZzogZmFsc2UsCgogICAgICAgICAgICBjb3Vyc2VJZDogbnVsbCwKICAgICAgICAgICAgdmlkZW9JZDogbnVsbCwKCiAgICAgICAgICAgIGNvdXJzZVZvOiB7fSwKICAgICAgICAgICAgZGVzY3JpcHRpb246ICcnLAogICAgICAgICAgICBjaGFwdGVyVm9MaXN0OiBbXSwKICAgICAgICAgICAgaXNCdXk6IGZhbHNlLAogICAgICAgICAgICAvLyBmaXJzdFZpZGVvOiBudWxsLAoKICAgICAgICAgICAgYWN0aXZlTmFtZXM6IFsiMSJdLAogICAgICAgICAgICBhY3RpdmVWaWRlb0lkOiAwLCAvL+iusOW9leW9k+WJjeato+WcqOaSreaUvueahOinhumikQogICAgICAgICAgICBwbGF5ZXI6IG51bGwKICAgICAgICB9OwogICAgfSwKCiAgICBjcmVhdGVkKCkgewogICAgICAgIHRoaXMuY291cnNlSWQgPSB0aGlzLiRyb3V0ZS5wYXJhbXMuY291cnNlSWQ7CiAgICAgICAgdGhpcy52aWRlb0lkID0gdGhpcy4kcm91dGUucGFyYW1zLnZpZGVvSWQgfHwgJzAnOwoKICAgICAgICB0aGlzLmZldGNoRGF0YSgpOwogICAgICAgIHRoaXMuZ2V0UGxheUF1dGgodGhpcy52aWRlb0lkKTsKICAgIH0sCgogICAgbWV0aG9kczogewogICAgICAgIGZldGNoRGF0YSgpIHsKICAgICAgICAgICAgdGhpcy5sb2FkaW5nID0gdHJ1ZTsKICAgICAgICAgICAgY291cnNlQXBpLmdldEluZm8odGhpcy5jb3Vyc2VJZCkudGhlbihyZXNwb25zZSA9PiB7CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZXNwb25zZS5kYXRhKTsKCiAgICAgICAgICAgICAgICB0aGlzLmNvdXJzZVZvID0gcmVzcG9uc2UuZGF0YS5jb3Vyc2VWbzsKICAgICAgICAgICAgICAgIHRoaXMuZGVzY3JpcHRpb24gPSByZXNwb25zZS5kYXRhLmRlc2NyaXB0aW9uOwogICAgICAgICAgICAgICAgdGhpcy5pc0J1eSA9IHJlc3BvbnNlLmRhdGEuaXNCdXk7CiAgICAgICAgICAgICAgICB0aGlzLmNoYXB0ZXJWb0xpc3QgPSByZXNwb25zZS5kYXRhLmNoYXB0ZXJWb0xpc3Q7CgogICAgICAgICAgICAgICAgdGhpcy5sb2FkaW5nID0gZmFsc2U7CiAgICAgICAgICAgIH0pOwogICAgICAgIH0sCgogICAgICAgIHNlZSh2aWRlbykgewogICAgICAgICAgICBsZXQgdmlkZW9JZCA9IHZpZGVvLmlkOwogICAgICAgICAgICBsZXQgaXNGcmVlID0gdmlkZW8uaXNGcmVlOwogICAgICAgICAgICAvL2lmKGlzRnJlZSA9PT0gMSB8fCB0aGlzLmlzQnV5IHx8IHRoaXMuY291cnNlVm8ucHJpY2UgPT0gJzAuMDAnKSB7CiAgICAgICAgICAgICAgICB0aGlzLmdldFBsYXlBdXRoKHZpZGVvSWQpOwogICAgICAgICAgICAvLyB9IGVsc2UgewogICAgICAgICAgICAvLyAgICAgaWYgKHdpbmRvdy5jb25maXJtKCLotK3kubDkuobmiY3lj6/ku6Xop4LnnIssIOaYr+WQpue7p+e7re+8nyIpKSB7CiAgICAgICAgICAgIC8vICAgICAgICAgdGhpcy5idXkoKQogICAgICAgICAgICAvLyAgICAgfQogICAgICAgICAgICAvLyB9CiAgICAgICAgfSwKCiAgICAgICAgYnV5KCkgewogICAgICAgICAgICB0aGlzLiRyb3V0ZXIucHVzaCh7IHBhdGg6ICcvdHJhZGUvJyt0aGlzLmNvdXJzZUlkIH0pCiAgICAgICAgfSwKCiAgICAgICAgZ2V0UGxheUF1dGgodmlkZW9JZCkgewogICAgICAgICAgICBpZiAodGhpcy5wbGF5ZXIgIT0gbnVsbCkgewogICAgICAgICAgICAgICAgLy8g5piv6ZSA5q+B5LmL5YmN55qE6KeG6aKR77yM5LiN6ZSA5q+B55qE6K+d77yM5a6D5Lya5LiA55u05a2Y5ZyoCiAgICAgICAgICAgICAgICB0aGlzLnBsYXllci5kaXNwb3NlKCk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHZvZEFwaS5nZXRQbGF5QXV0aCh0aGlzLmNvdXJzZUlkLCB2aWRlb0lkKS50aGVuKHJlc3BvbnNlID0+IHsKICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlc3BvbnNlLmRhdGEpOwogICAgICAgICAgICAgICAgdGhpcy5wbGF5KHJlc3BvbnNlLmRhdGEpOwoKICAgICAgICAgICAgICAgIC8v5bGV5byA56ug6IqCCiAgICAgICAgICAgICAgICB0aGlzLmFjdGl2ZU5hbWVzID0gW3Jlc3BvbnNlLmRhdGEuY2hhcHRlcklkXQogICAgICAgICAgICAgICAgLy/pgInkuK3mkq3mlL7op4bpopEKICAgICAgICAgICAgICAgIHRoaXMuYWN0aXZlVmlkZW9JZCA9IHJlc3BvbnNlLmRhdGEudmlkZW9JZAogICAgICAgICAgICB9KQogICAgICAgIH0sCgkJLy/op4bpopHmkq3mlL4KICAgICAgICBwbGF5KGRhdGEpIHsKICAgICAgICAgICAgLy93aW5kb3cubG9jYXRpb24gPSAnLi92aWRlby5odG1sP2ZpbGVJRD0nK2RhdGEudmlkZW9Tb3VyY2VJZCsnJmFwcElEPScrZGF0YS5hcHBJZDsKICAgICAgICAgICAgdmFyIHBsYXllciA9IFRDUGxheWVyKCJwbGF5ZXItY29udGFpbmVyLWlkIiwgeyAvKipwbGF5ZXItY29udGFpbmVyLWlkIOS4uuaSreaUvuWZqOWuueWZqElE77yM5b+F6aG75LiOaHRtbOS4reS4gOiHtCovCiAgICAgICAgICAgICAgICBmaWxlSUQ6IGRhdGEudmlkZW9Tb3VyY2VJZCwgLyoq6K+35Lyg5YWl6ZyA6KaB5pKt5pS+55qE6KeG6aKRZmlsZUlEIOW/hemhuyAqLwogICAgICAgICAgICAgICAgYXBwSUQ6IGRhdGEuYXBwSWQsIC8qKuivt+S8oOWFpeeCueaSrei0puWPt+eahOWtkOW6lOeUqGFwcElEIOW/hemhuyAqLwogICAgICAgICAgICAgICAgcHNpZ246ICIiCiAgICAgICAgICAgICAgICAvKirlhbbku5blj4LmlbDor7flnKjlvIDlj5HmlofmoaPkuK3mn6XnnIsgKi8KICAgICAgICAgICAgIH0pOwogICAgICAgIH0KICAgIH0KfTsK"},{"version":3,"sources":["play.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwCA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"play.vue","sourceRoot":"src/views","sourcesContent":["<template>\n    <div>\n        <video id=\"player-container-id\" preload=\"auto\" width=\"600\" height=\"400\" playsinline webkit-playsinline x5-playsinline></video>\n        <h1 class=\"van-ellipsis course_title\">{{ courseVo.title }}</h1>\n\n        <div class=\"course_teacher_price_box\">\n            <div class=\"course_teacher_price\">\n                <div class=\"course_price\">价格：</div>\n                <div class=\"course_price_number\">￥{{ courseVo.price }}</div>\n                <div class=\"course_teacher\">主讲： {{ courseVo.teacherName }}</div>\n            </div>\n            <div>\n                <van-button @click=\"getPlayAuth('0')\" v-if=\"isBuy || courseVo.price == '0.00'\" plain type=\"warning\" size=\"mini\">立即观看</van-button>\n                <van-button @click=\"buy\" v-else plain type=\"warning\" size=\"mini\">立即购买</van-button>\n            </div>\n        </div>\n\n        <div class=\"course_contents\">\n            <div class=\"course_title_font\">课程大纲</div>\n            <div class=\"gap\"></div>\n            <van-collapse v-model=\"activeNames\">\n                <van-collapse-item :title=\"item.title\" :name=\"item.id\" v-for=\"item in chapterVoList\" :key=\"item.id\">\n                    <ul class=\"course_chapter_list\" v-for=\"child in item.children\" :key=\"child.id\">\n                        <h2 :style=\"activeVideoId == child.id ? 'color:blue' : ''\">{{child.title}}</h2>\n                        <p v-if=\"child.isFree == 1\">\n                            <van-button @click=\"see(child)\" type=\"warning\" size=\"mini\" plain>免费观看</van-button>\n                        </p>\n                        <p v-else>\n                            <van-button @click=\"see(child)\" type=\"warning\" size=\"mini\" plain>观看</van-button>\n                        </p>\n                    </ul>\n                </van-collapse-item>\n            </van-collapse>\n        </div>\n\n        <van-loading vertical=\"true\" v-show=\"loading\">加载中...</van-loading>\n    </div>\n</template>\n\n<script>\nimport courseApi from '@/api/course'\nimport vodApi from '@/api/vod'\n// import videoVisitorApi from '@/api/videoVisitor'\nexport default {\n    data() {\n        return {\n            loading: false,\n\n            courseId: null,\n            videoId: null,\n\n            courseVo: {},\n            description: '',\n            chapterVoList: [],\n            isBuy: false,\n            // firstVideo: null,\n\n            activeNames: [\"1\"],\n            activeVideoId: 0, //记录当前正在播放的视频\n            player: null\n        };\n    },\n\n    created() {\n        this.courseId = this.$route.params.courseId;\n        this.videoId = this.$route.params.videoId || '0';\n\n        this.fetchData();\n        this.getPlayAuth(this.videoId);\n    },\n\n    methods: {\n        fetchData() {\n            this.loading = true;\n            courseApi.getInfo(this.courseId).then(response => {\n                console.log(response.data);\n\n                this.courseVo = response.data.courseVo;\n                this.description = response.data.description;\n                this.isBuy = response.data.isBuy;\n                this.chapterVoList = response.data.chapterVoList;\n\n                this.loading = false;\n            });\n        },\n\n        see(video) {\n            let videoId = video.id;\n            let isFree = video.isFree;\n            //if(isFree === 1 || this.isBuy || this.courseVo.price == '0.00') {\n                this.getPlayAuth(videoId);\n            // } else {\n            //     if (window.confirm(\"购买了才可以观看, 是否继续？\")) {\n            //         this.buy()\n            //     }\n            // }\n        },\n\n        buy() {\n            this.$router.push({ path: '/trade/'+this.courseId })\n        },\n\n        getPlayAuth(videoId) {\n            if (this.player != null) {\n                // 是销毁之前的视频，不销毁的话，它会一直存在\n                this.player.dispose();\n            }\n\n            vodApi.getPlayAuth(this.courseId, videoId).then(response => {\n                console.log(response.data);\n                this.play(response.data);\n\n                //展开章节\n                this.activeNames = [response.data.chapterId]\n                //选中播放视频\n                this.activeVideoId = response.data.videoId\n            })\n        },\n\t\t//视频播放\n        play(data) {\n            //window.location = './video.html?fileID='+data.videoSourceId+'&appID='+data.appId;\n            var player = TCPlayer(\"player-container-id\", { /**player-container-id 为播放器容器ID，必须与html中一致*/\n                fileID: data.videoSourceId, /**请传入需要播放的视频fileID 必须 */\n                appID: data.appId, /**请传入点播账号的子应用appID 必须 */\n                psign: \"\"\n                /**其他参数请在开发文档中查看 */\n             });\n        }\n    }\n};\n</script>\n\n<style lang=\"scss\" scoped>\n.gap {\n    height: 10px;\n}\n\n::v-deep.van-image {\n    display: block;\n}\n\n.course_count {\n    background-color: #82848a;\n    color: white;\n    padding: 5px;\n    text-align: center;\n    border-right: 1px solid #939393;\n\n    h1 {\n        font-size: 14px;\n        margin: 0;\n    }\n\n    p {\n        margin: 0;\n        font-size: 16px;\n    }\n}\n\n.course_title {\n    font-size: 20px;\n    margin: 10px;\n}\n\n.course_teacher_price_box {\n    margin: 10px;\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n\n    .course_teacher_price {\n        display: flex;\n        font-size: 14px;\n        align-items: center;\n\n        .course_price_number {\n            color: red;\n            font-size: 18px;\n            font-weight: bold;\n        }\n\n        .course_teacher {\n            margin-left: 20px;\n        }\n    }\n}\n\n.course_contents {\n    margin: 10px;\n\n    .course_title_font {\n        color: #68cb9b;\n        font-weight: bold;\n    }\n\n    .course_content {\n        margin-bottom: 20px;\n    }\n}\n\n.course_chapter_list {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n\n    h2 {\n        font-size: 14px;\n    }\n\n    p {\n        margin: 0;\n    }\n}\n</style>"]}]}